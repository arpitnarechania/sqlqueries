CREATE INDEX serviceesc_contacts_i_id_idx on icinga_serviceescalation_contacts(instance_id);
CREATE TABLE IF NOT EXISTS icinga_timeperiod_timeranges ( timeperiod_timerange_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, timeperiod_id bigint unsigned default 0, day smallint default 0, start_sec int default 0, end_sec int default 0, PRIMARY KEY (timeperiod_timerange_id))
CREATE INDEX services_combined_object_idx ON icinga_services(service_object_id, host_object_id);
create index idx_scheduleddowntime_remove on icinga_scheduleddowntime (object_id, entry_time, scheduled_start_time, scheduled_end_time);
CREATE INDEX contact_notifcommands_i_id_idx on icinga_contact_notificationcommands(instance_id);
CREATE INDEX srvcstatus_problem_ack_idx on icinga_servicestatus(problem_has_been_acknowledged);
CREATE INDEX srvcstatus_event_hdl_en_idx on icinga_servicestatus(event_handler_enabled);
CREATE INDEX d_t_hist_nstance_id_idx on icinga_downtimehistory(instance_id);
CREATE INDEX hoststatus_state_type_idx on icinga_hoststatus(state_type);
CREATE INDEX hostgroups_i_id_idx on icinga_hostgroups(instance_id);
CREATE INDEX srvcstatus_current_state_idx on icinga_servicestatus(current_state);
CREATE INDEX sched_d_t_entry_time_idx on icinga_scheduleddowntime(entry_time);
CREATE INDEX hoststatus_sch_downt_d_idx on icinga_hoststatus(scheduled_downtime_depth);
CREATE TABLE IF NOT EXISTS icinga_commands ( command_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, config_type smallint default 0, object_id bigint unsigned default 0, command_line TEXT character set latin1, config_hash varchar(64) DEFAULT NULL, PRIMARY KEY (command_id), UNIQUE KEY instance_id (instance_id,object_id,config_type))
CREATE INDEX contactstatus_i_id_idx on icinga_contactstatus(instance_id);
CREATE TABLE icinga_serviceescalation_contacts ( serviceescalation_contact_id bigserial, instance_id bigint default 0, serviceescalation_id bigint default 0, contact_object_id bigint default 0, CONSTRAINT PK_serviceescalation_contact_id PRIMARY KEY (serviceescalation_contact_id) , CONSTRAINT UQ_serviceescalation_contacts UNIQUE (instance_id,serviceescalation_id,contact_object_id))
CREATE INDEX objects_name2_idx ON icinga_objects(name2);
CREATE INDEX contact_notification_idx ON icinga_contactnotifications(notification_id, contact_object_id);
CREATE TABLE IF NOT EXISTS icinga_zones ( zone_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, zone_object_id bigint(20) unsigned DEFAULT '0', config_type smallint(6) DEFAULT '0', parent_zone_object_id bigint(20) unsigned DEFAULT '0', is_global smallint(6), PRIMARY KEY (zone_id))
CREATE TABLE icinga_configfiles ( configfile_id bigserial, instance_id bigint default 0, configfile_type INTEGER default 0, configfile_path TEXT default '', CONSTRAINT PK_configfile_id PRIMARY KEY (configfile_id) , CONSTRAINT UQ_configfiles UNIQUE (instance_id,configfile_type,configfile_path))
CREATE INDEX idx_downtimes_session_del ON icinga_scheduleddowntime (instance_id, session_token);
CREATE INDEX srvcstatus_sch_downt_d_idx on icinga_servicestatus(scheduled_downtime_depth);
CREATE TABLE IF NOT EXISTS icinga_contact_addresses ( contact_address_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, contact_id bigint unsigned default 0, address_number smallint default 0, address varchar(255) character set latin1 default '', PRIMARY KEY (contact_address_id), UNIQUE KEY contact_id (contact_id,address_number))
CREATE INDEX eventhandlers_time_id_idx on icinga_eventhandlers(start_time);
CREATE INDEX hstcntgrps_hid_cgoid ON icinga_host_contactgroups (host_id,contactgroup_object_id);
CREATE TABLE IF NOT EXISTS icinga_serviceescalation_contactgroups ( serviceescalation_contactgroup_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, serviceescalation_id bigint unsigned default 0, contactgroup_object_id bigint unsigned default 0, PRIMARY KEY (serviceescalation_contactgroup_id), UNIQUE KEY instance_id (serviceescalation_id,contactgroup_object_id))
CREATE INDEX comments_i_id_idx on icinga_comments(instance_id);
CREATE INDEX contact_notif_meth_notif_idx ON icinga_contactnotificationmethods(contactnotification_id, command_object_id);
CREATE INDEX idx_zones_object_id on icinga_zones(zone_object_id);
CREATE INDEX services_i_id_idx on icinga_services(instance_id);
CREATE INDEX objects_name1_idx ON icinga_objects(name1);
CREATE INDEX idx_comments_object_id on icinga_comments(object_id);
CREATE TABLE icinga_hostgroups ( hostgroup_id bigserial, instance_id bigint default 0, config_type INTEGER default 0, hostgroup_object_id bigint default 0, alias TEXT default '', notes TEXT default NULL, notes_url TEXT default NULL, action_url TEXT default NULL, config_hash varchar(64) DEFAULT NULL, CONSTRAINT PK_hostgroup_id PRIMARY KEY (hostgroup_id) , CONSTRAINT UQ_hostgroups UNIQUE (instance_id,hostgroup_object_id))
CREATE INDEX tperiod_tid_d_ss_es ON icinga_timeperiod_timeranges (timeperiod_id,
CREATE TABLE icinga_zones ( zone_id bigserial, instance_id bigint default 0, zone_object_id bigint default 0, parent_zone_object_id bigint default 0, config_type integer default 0, is_global integer default 0, config_hash varchar(64) DEFAULT NULL, CONSTRAINT PK_zone_id PRIMARY KEY (zone_id) , CONSTRAINT UQ_zones UNIQUE (instance_id,config_type,zone_object_id))
CREATE TABLE icinga_host_contacts ( host_contact_id bigserial, instance_id bigint default 0, host_id bigint default 0, contact_object_id bigint default 0, CONSTRAINT PK_host_contact_id PRIMARY KEY (host_contact_id))
CREATE INDEX hoststatus_check_type_idx on icinga_hoststatus(check_type);
CREATE TABLE IF NOT EXISTS icinga_conninfo ( conninfo_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, agent_name varchar(32) character set latin1 default '', agent_version varchar(32) character set latin1 default '', disposition varchar(32) character set latin1 default '', connect_source varchar(32) character set latin1 default '', connect_type varchar(32) character set latin1 default '', connect_time timestamp NULL, disconnect_time timestamp NULL, last_checkin_time timestamp NULL, data_start_time timestamp NULL, data_end_time timestamp NULL, bytes_processed bigint unsigned default '0', lines_processed bigint unsigned default '0', entries_processed bigint unsigned default '0', PRIMARY KEY (conninfo_id))
CREATE TABLE IF NOT EXISTS icinga_contactstatus ( contactstatus_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, contact_object_id bigint unsigned default 0, status_update_time timestamp NULL, host_notifications_enabled smallint default 0, service_notifications_enabled smallint default 0, last_host_notification timestamp NULL, last_service_notification timestamp NULL, modified_attributes int default 0, modified_host_attributes int default 0, modified_service_attributes int default 0, PRIMARY KEY (contactstatus_id), UNIQUE KEY contact_object_id (contact_object_id))
CREATE TABLE IF NOT EXISTS icinga_endpoints ( endpoint_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, endpoint_object_id bigint(20) unsigned DEFAULT '0', zone_object_id bigint(20) unsigned DEFAULT '0', config_type smallint(6) DEFAULT '0', identity varchar(255) DEFAULT NULL, node varchar(255) DEFAULT NULL, config_hash varchar(64) DEFAULT NULL, PRIMARY KEY (endpoint_id))
CREATE INDEX objects_inst_id_idx ON icinga_objects(instance_id);
CREATE INDEX notification_idx ON icinga_notifications(notification_type, object_id, start_time);
CREATE TABLE IF NOT EXISTS icinga_hostgroup_members ( hostgroup_member_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, hostgroup_id bigint unsigned default 0, host_object_id bigint unsigned default 0, PRIMARY KEY (hostgroup_member_id))
CREATE TABLE icinga_conninfo ( conninfo_id bigserial, instance_id bigint default 0, agent_name TEXT default '', agent_version TEXT default '', disposition TEXT default '', connect_source TEXT default '', connect_type TEXT default '', connect_time timestamp, disconnect_time timestamp, last_checkin_time timestamp, data_start_time timestamp, data_end_time timestamp, bytes_processed bigint default 0, lines_processed bigint default 0, entries_processed bigint default 0, CONSTRAINT PK_conninfo_id PRIMARY KEY (conninfo_id))
CREATE TABLE icinga_timeperiod_timeranges ( timeperiod_timerange_id bigserial, instance_id bigint default 0, timeperiod_id bigint default 0, day INTEGER default 0, start_sec INTEGER default 0, end_sec INTEGER default 0, CONSTRAINT PK_timeperiod_timerange_id PRIMARY KEY (timeperiod_timerange_id))
CREATE INDEX loge_instance_id_idx on icinga_logentries(instance_id);
CREATE TABLE IF NOT EXISTS icinga_contactgroups ( contactgroup_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, config_type smallint default 0, contactgroup_object_id bigint unsigned default 0, alias varchar(255) character set latin1 default '', config_hash varchar(64) DEFAULT NULL, PRIMARY KEY (contactgroup_id), UNIQUE KEY instance_id (instance_id,config_type,contactgroup_object_id))
CREATE TABLE icinga_scheduleddowntime ( scheduleddowntime_id bigserial, instance_id bigint default 0, downtime_type INTEGER default 0, object_id bigint default 0, entry_time timestamp, author_name TEXT default '', comment_data TEXT default '', internal_downtime_id bigint default 0, triggered_by_id bigint default 0, is_fixed INTEGER default 0, duration BIGINT default 0, scheduled_start_time timestamp, scheduled_end_time timestamp, was_started INTEGER default 0, actual_start_time timestamp, actual_start_time_usec INTEGER default 0, is_in_effect INTEGER default 0, trigger_time timestamp, name TEXT default NULL, session_token INTEGER default NULL, CONSTRAINT PK_scheduleddowntime_id PRIMARY KEY (scheduleddowntime_id))
CREATE INDEX objects_objtype_id_idx ON icinga_objects(objecttype_id);
CREATE TABLE IF NOT EXISTS icinga_contact_notificationcommands ( contact_notificationcommand_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, contact_id bigint unsigned default 0, notification_type smallint default 0, command_object_id bigint unsigned default 0, command_args varchar(255) character set latin1 default '', PRIMARY KEY (contact_notificationcommand_id), UNIQUE KEY contact_id (contact_id,notification_type,command_object_id,command_args))
CREATE TABLE IF NOT EXISTS icinga_dbversion ( dbversion_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, name varchar(10) character set latin1 default '', version varchar(10) character set latin1 default '', create_time timestamp NULL, modify_time timestamp NULL, PRIMARY KEY (dbversion_id), UNIQUE KEY dbversion (name))
CREATE TABLE IF NOT EXISTS icinga_notifications ( notification_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, notification_type smallint default 0, notification_reason smallint default 0, object_id bigint unsigned default 0, start_time timestamp NULL, start_time_usec int default 0, end_time timestamp NULL, end_time_usec int default 0, state smallint default 0, output TEXT character set latin1, long_output TEXT, escalated smallint default 0, contacts_notified smallint default 0, PRIMARY KEY (notification_id), UNIQUE KEY instance_id (instance_id,object_id,start_time,start_time_usec))
CREATE TABLE icinga_processevents ( processevent_id bigserial, instance_id bigint default 0, event_type INTEGER default 0, event_time timestamp, event_time_usec INTEGER default 0, process_id bigint default 0, program_name TEXT default '', program_version TEXT default '', program_date TEXT default '', CONSTRAINT PK_processevent_id PRIMARY KEY (processevent_id))
CREATE INDEX srvcstatus_is_flapping_idx on icinga_servicestatus(is_flapping);
CREATE TABLE icinga_service_contactgroups ( service_contactgroup_id bigserial, instance_id bigint default 0, service_id bigint default 0, contactgroup_object_id bigint default 0, CONSTRAINT PK_service_contactgroup_id PRIMARY KEY (service_contactgroup_id))
CREATE INDEX servicechks_s_obj_id_idx on icinga_servicechecks(service_object_id);
CREATE TABLE IF NOT EXISTS icinga_servicedependencies ( servicedependency_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, config_type smallint default 0, service_object_id bigint unsigned default 0, dependent_service_object_id bigint unsigned default 0, dependency_type smallint default 0, inherits_parent smallint default 0, timeperiod_object_id bigint unsigned default 0, fail_on_ok smallint default 0, fail_on_warning smallint default 0, fail_on_unknown smallint default 0, fail_on_critical smallint default 0, PRIMARY KEY (servicedependency_id), KEY instance_id (instance_id,config_type,service_object_id,dependent_service_object_id,dependency_type,inherits_parent,fail_on_ok,fail_on_warning,fail_on_unknown,fail_on_critical))
CREATE TABLE IF NOT EXISTS icinga_service_contacts ( service_contact_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, service_id bigint unsigned default 0, contact_object_id bigint unsigned default 0, PRIMARY KEY (service_contact_id))
CREATE INDEX cv_session_del_idx ON icinga_customvariables (session_token);
CREATE INDEX command_object_idx ON icinga_commands(object_id);
CREATE TABLE IF NOT EXISTS icinga_commenthistory ( commenthistory_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, entry_time timestamp NULL, entry_time_usec int default 0, comment_type smallint default 0, entry_type smallint default 0, object_id bigint unsigned default 0, comment_time timestamp NULL, internal_comment_id bigint unsigned default 0, author_name varchar(64) character set latin1 default '', comment_data TEXT character set latin1, is_persistent smallint default 0, comment_source smallint default 0, expires smallint default 0, expiration_time timestamp NULL, deletion_time timestamp NULL, deletion_time_usec int default 0, name TEXT character set latin1 default NULL, PRIMARY KEY (commenthistory_id))
CREATE TABLE IF NOT EXISTS icinga_contactgroup_members ( contactgroup_member_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, contactgroup_id bigint unsigned default 0, contact_object_id bigint unsigned default 0, PRIMARY KEY (contactgroup_member_id))
CREATE TABLE IF NOT EXISTS icinga_hostgroups ( hostgroup_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, config_type smallint default 0, hostgroup_object_id bigint unsigned default 0, alias varchar(255) character set latin1 default '', notes TEXT character set latin1 default NULL, notes_url TEXT character set latin1 default NULL, action_url TEXT character set latin1 default NULL, config_hash varchar(64) DEFAULT NULL, PRIMARY KEY (hostgroup_id), UNIQUE KEY instance_id (instance_id,hostgroup_object_id))
CREATE TABLE IF NOT EXISTS icinga_hostdependencies ( hostdependency_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, config_type smallint default 0, host_object_id bigint unsigned default 0, dependent_host_object_id bigint unsigned default 0, dependency_type smallint default 0, inherits_parent smallint default 0, timeperiod_object_id bigint unsigned default 0, fail_on_up smallint default 0, fail_on_down smallint default 0, fail_on_unreachable smallint default 0, PRIMARY KEY (hostdependency_id), KEY instance_id (instance_id,config_type,host_object_id,dependent_host_object_id,dependency_type,inherits_parent,fail_on_up,fail_on_down,fail_on_unreachable))
CREATE TABLE IF NOT EXISTS icinga_servicegroups ( servicegroup_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, config_type smallint default 0, servicegroup_object_id bigint unsigned default 0, alias varchar(255) character set latin1 default '', notes TEXT character set latin1 default NULL, notes_url TEXT character set latin1 default NULL, action_url TEXT character set latin1 default NULL, config_hash varchar(64) DEFAULT NULL, PRIMARY KEY (servicegroup_id), UNIQUE KEY instance_id (instance_id,config_type,servicegroup_object_id))
CREATE INDEX scheduleddowntime_i_id_idx on icinga_scheduleddowntime(instance_id);
CREATE TABLE IF NOT EXISTS icinga_hostescalation_contacts ( hostescalation_contact_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, hostescalation_id bigint unsigned default 0, contact_object_id bigint unsigned default 0, PRIMARY KEY (hostescalation_contact_id), UNIQUE KEY instance_id (instance_id,hostescalation_id,contact_object_id))
CREATE INDEX srvcstatus_p_state_chg_idx on icinga_servicestatus(percent_state_change);
CREATE INDEX hoststatus_current_state_idx on icinga_hoststatus(current_state);
CREATE INDEX eventhandlers_i_id_idx on icinga_eventhandlers(instance_id);
CREATE INDEX systemcommands_i_id_idx on icinga_systemcommands(instance_id);
CREATE TABLE icinga_systemcommands ( systemcommand_id bigserial, instance_id bigint default 0, start_time timestamp, start_time_usec INTEGER default 0, end_time timestamp, end_time_usec INTEGER default 0, command_line TEXT default '', timeout INTEGER default 0, early_timeout INTEGER default 0, execution_time double precision default 0, return_code INTEGER default 0, output TEXT default '', long_output TEXT default '', CONSTRAINT PK_systemcommand_id PRIMARY KEY (systemcommand_id) , CONSTRAINT UQ_systemcommands UNIQUE (instance_id,start_time,start_time_usec))
CREATE TABLE IF NOT EXISTS icinga_logentries ( logentry_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, logentry_time timestamp NULL, entry_time timestamp NULL, entry_time_usec int default 0, logentry_type int default 0, logentry_data TEXT character set latin1, realtime_data smallint default 0, inferred_data_extracted smallint default 0, object_id bigint unsigned default NULL, PRIMARY KEY (logentry_id))
CREATE INDEX programstatus_i_id_idx on icinga_programstatus(instance_id);
CREATE INDEX srvcstatus_pas_chks_en_idx on icinga_servicestatus(passive_checks_enabled);
CREATE INDEX contact_addresses_i_id_idx on icinga_contact_addresses(instance_id);
CREATE TABLE IF NOT EXISTS icinga_acknowledgements ( acknowledgement_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, entry_time timestamp NULL, entry_time_usec int default 0, acknowledgement_type smallint default 0, object_id bigint unsigned default 0, state smallint default 0, author_name varchar(64) character set latin1 default '', comment_data TEXT character set latin1, is_sticky smallint default 0, persistent_comment smallint default 0, notify_contacts smallint default 0, end_time timestamp NULL, PRIMARY KEY (acknowledgement_id))
SELECT instance_id FROM " + GetTablePrefix() + "instances WHERE instance_name = '" + Escape(instanceName) + "'
CREATE INDEX servicegroups_i_id_idx on icinga_servicegroups(instance_id);
CREATE INDEX hstprnthsts_hid_phoid ON icinga_host_parenthosts (host_id,parent_host_object_id);
CREATE INDEX srvcstatus_ex_time_idx on icinga_servicestatus(execution_time);
CREATE INDEX c_hist_c_time_idx on icinga_logentries(comment_time);
CREATE INDEX d_t_hist_sched_end_idx on icinga_downtimehistory(scheduled_end_time);
CREATE TABLE icinga_serviceescalations ( serviceescalation_id bigserial, instance_id bigint default 0, config_type INTEGER default 0, service_object_id bigint default 0, timeperiod_object_id bigint default 0, first_notification INTEGER default 0, last_notification INTEGER default 0, notification_interval double precision default 0, escalate_on_recovery INTEGER default 0, escalate_on_warning INTEGER default 0, escalate_on_unknown INTEGER default 0, escalate_on_critical INTEGER default 0, CONSTRAINT PK_serviceescalation_id PRIMARY KEY (serviceescalation_id) , CONSTRAINT UQ_serviceescalations UNIQUE (instance_id,config_type,service_object_id,timeperiod_object_id,first_notification,last_notification))
CREATE INDEX srvcstatus_notif_enabled_idx on icinga_servicestatus(notifications_enabled);
CREATE TABLE IF NOT EXISTS icinga_host_parenthosts ( host_parenthost_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, host_id bigint unsigned default 0, parent_host_object_id bigint unsigned default 0, PRIMARY KEY (host_parenthost_id))
CREATE TABLE IF NOT EXISTS icinga_flappinghistory ( flappinghistory_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, event_time timestamp NULL, event_time_usec int default 0, event_type smallint default 0, reason_type smallint default 0, flapping_type smallint default 0, object_id bigint unsigned default 0, percent_state_change double default '0', low_threshold double default '0', high_threshold double default '0', comment_time timestamp NULL, internal_comment_id bigint unsigned default 0, PRIMARY KEY (flappinghistory_id))
CREATE INDEX sgmbrs_sgid_soid ON icinga_servicegroup_members (servicegroup_id,service_object_id);
CREATE INDEX cvs_session_del_idx ON icinga_customvariablestatus (session_token);
CREATE INDEX loge_inst_id_time_idx on icinga_logentries (instance_id 
CREATE INDEX sched_d_t_end_time_idx on icinga_scheduleddowntime(scheduled_end_time);
CREATE INDEX srvcstatus_check_type_idx on icinga_servicestatus(check_type);
CREATE INDEX d_t_hist_type_idx on icinga_downtimehistory(downtime_type);
CREATE INDEX loge_data_idx on icinga_logentries(logentry_data);
CREATE TABLE icinga_service_contacts ( service_contact_id bigserial, instance_id bigint default 0, service_id bigint default 0, contact_object_id bigint default 0, CONSTRAINT PK_service_contact_id PRIMARY KEY (service_contact_id))
CREATE INDEX configfiles_i_id_idx on icinga_configfiles(instance_id);
CREATE TABLE icinga_servicedependencies ( servicedependency_id bigserial, instance_id bigint default 0, config_type INTEGER default 0, service_object_id bigint default 0, dependent_service_object_id bigint default 0, dependency_type INTEGER default 0, inherits_parent INTEGER default 0, timeperiod_object_id bigint default 0, fail_on_ok INTEGER default 0, fail_on_warning INTEGER default 0, fail_on_unknown INTEGER default 0, fail_on_critical INTEGER default 0, CONSTRAINT PK_servicedependency_id PRIMARY KEY (servicedependency_id))
CREATE TABLE icinga_servicegroup_members ( servicegroup_member_id bigserial, instance_id bigint default 0, servicegroup_id bigint default 0, service_object_id bigint default 0, session_token INTEGER default NULL, CONSTRAINT PK_servicegroup_member_id PRIMARY KEY (servicegroup_member_id))
CREATE TABLE icinga_acknowledgements ( acknowledgement_id bigserial, instance_id bigint default 0, entry_time timestamp, entry_time_usec INTEGER default 0, acknowledgement_type INTEGER default 0, object_id bigint default 0, state INTEGER default 0, author_name TEXT default '', comment_data TEXT default '', is_sticky INTEGER default 0, persistent_comment INTEGER default 0, notify_contacts INTEGER default 0, end_time timestamp, CONSTRAINT PK_acknowledgement_id PRIMARY KEY (acknowledgement_id))
CREATE INDEX idx_service_contacts_service_id on icinga_service_contacts(service_id);
CREATE TABLE IF NOT EXISTS icinga_comments ( comment_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, entry_time timestamp NULL, entry_time_usec int default 0, comment_type smallint default 0, entry_type smallint default 0, object_id bigint unsigned default 0, comment_time timestamp NULL, internal_comment_id bigint unsigned default 0, author_name varchar(64) character set latin1 default '', comment_data TEXT character set latin1, is_persistent smallint default 0, comment_source smallint default 0, expires smallint default 0, expiration_time timestamp NULL, name TEXT character set latin1 default NULL, session_token int default NULL, PRIMARY KEY (comment_id))
CREATE INDEX idx_host_contacts_host_id on icinga_host_contacts(host_id);
CREATE TABLE IF NOT EXISTS icinga_statehistory ( statehistory_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, state_time timestamp NULL, state_time_usec int default 0, object_id bigint unsigned default 0, state_change smallint default 0, state smallint default 0, state_type smallint default 0, current_check_attempt smallint default 0, max_check_attempts smallint default 0, last_state smallint default 0, last_hard_state smallint default 0, output TEXT character set latin1, long_output TEXT, check_source varchar(255) character set latin1 default NULL, PRIMARY KEY (statehistory_id))
CREATE INDEX runtimevars_iid_varn ON icinga_runtimevariables (instance_id,varname);
CREATE INDEX hosts_i_id_idx on icinga_hosts(instance_id);
CREATE INDEX host_contactgroups_i_id_idx on icinga_host_contactgroups(instance_id);
CREATE INDEX srvcstatus_act_chks_en_idx on icinga_servicestatus(active_checks_enabled);
CREATE TABLE icinga_contactnotifications ( contactnotification_id bigserial, instance_id bigint default 0, notification_id bigint default 0, contact_object_id bigint default 0, start_time timestamp, start_time_usec INTEGER default 0, end_time timestamp, end_time_usec INTEGER default 0, CONSTRAINT PK_contactnotification_id PRIMARY KEY (contactnotification_id) , CONSTRAINT UQ_contactnotifications UNIQUE (instance_id,contact_object_id,start_time,start_time_usec))
CREATE INDEX servicechecks_i_id_idx on icinga_servicechecks(instance_id);
CREATE TABLE icinga_endpointstatus ( endpointstatus_id bigserial, instance_id bigint default 0, endpoint_object_id bigint default 0, zone_object_id bigint default 0, status_update_time timestamp, identity text DEFAULT NULL, node text DEFAULT NULL, is_connected integer default 0, CONSTRAINT PK_endpointstatus_id PRIMARY KEY (endpointstatus_id) , CONSTRAINT UQ_endpointstatus UNIQUE (endpoint_object_id))
CREATE INDEX d_t_hist_sched_start_idx on icinga_downtimehistory(scheduled_start_time);
CREATE INDEX statehist_i_id_o_id_s_ty_s_ti on icinga_statehistory(instance_id, object_id, state_type, state_time);
CREATE INDEX idx_scheduleddowntime_object_id on icinga_scheduleddowntime(object_id);
CREATE INDEX hostdependencies_i_id_idx on icinga_hostdependencies(instance_id);
CREATE TABLE icinga_endpoints ( endpoint_id bigserial, instance_id bigint default 0, endpoint_object_id bigint default 0, zone_object_id bigint default 0, config_type integer default 0, identity text DEFAULT NULL, node text DEFAULT NULL, config_hash varchar(64) DEFAULT NULL, CONSTRAINT PK_endpoint_id PRIMARY KEY (endpoint_id) , CONSTRAINT UQ_endpoints UNIQUE (instance_id,config_type,endpoint_object_id))
CREATE TABLE icinga_customvariables ( customvariable_id bigserial, instance_id bigint default 0, object_id bigint default 0, config_type INTEGER default 0, has_been_modified INTEGER default 0, varname TEXT default '', varvalue TEXT default '', is_json INTEGER default 0, session_token INTEGER default NULL, CONSTRAINT PK_customvariable_id PRIMARY KEY (customvariable_id) , CONSTRAINT UQ_customvariables UNIQUE (object_id,config_type,varname))
CREATE INDEX hostesc_i_id_idx on icinga_hostescalations(instance_id);
CREATE TABLE icinga_zonestatus ( zonestatus_id bigserial, instance_id bigint default 0, zone_object_id bigint default 0, parent_zone_object_id bigint default 0, status_update_time timestamp, CONSTRAINT PK_zonestatus_id PRIMARY KEY (zonestatus_id) , CONSTRAINT UQ_zonestatus UNIQUE (zone_object_id))
CREATE INDEX hostesc_cgroups_i_id_idx on icinga_hostescalation_contactgroups(instance_id);
CREATE INDEX hoststatus_event_hdl_en_idx on icinga_hoststatus(event_handler_enabled);
CREATE TABLE IF NOT EXISTS icinga_customvariablestatus ( customvariablestatus_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, object_id bigint unsigned default 0, status_update_time timestamp NULL, has_been_modified smallint default 0, varname varchar(255) character set latin1 collate latin1_general_cs default NULL, varvalue TEXT character set latin1, is_json smallint default 0, PRIMARY KEY (customvariablestatus_id), UNIQUE KEY object_id_2 (object_id,varname), KEY varname (varname))
CREATE TABLE IF NOT EXISTS icinga_serviceescalations ( serviceescalation_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, config_type smallint default 0, service_object_id bigint unsigned default 0, timeperiod_object_id bigint unsigned default 0, first_notification smallint default 0, last_notification smallint default 0, notification_interval double default '0', escalate_on_recovery smallint default 0, escalate_on_warning smallint default 0, escalate_on_unknown smallint default 0, escalate_on_critical smallint default 0, PRIMARY KEY (serviceescalation_id), UNIQUE KEY instance_id (instance_id,config_type,service_object_id,timeperiod_object_id,first_notification,last_notification))
CREATE TABLE IF NOT EXISTS icinga_zonestatus ( zonestatus_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, zone_object_id bigint(20) unsigned DEFAULT '0', status_update_time timestamp NULL, parent_zone_object_id bigint(20) unsigned DEFAULT '0', PRIMARY KEY (zonestatus_id))
CREATE TABLE IF NOT EXISTS icinga_systemcommands ( systemcommand_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, start_time timestamp NULL, start_time_usec int default 0, end_time timestamp NULL, end_time_usec int default 0, command_line TEXT character set latin1, timeout smallint default 0, early_timeout smallint default 0, execution_time double default '0', return_code smallint default 0, output TEXT character set latin1, long_output TEXT, PRIMARY KEY (systemcommand_id), UNIQUE KEY instance_id (instance_id,start_time,start_time_usec))
CREATE TABLE icinga_hostescalations ( hostescalation_id bigserial, instance_id bigint default 0, config_type INTEGER default 0, host_object_id bigint default 0, timeperiod_object_id bigint default 0, first_notification INTEGER default 0, last_notification INTEGER default 0, notification_interval double precision default 0, escalate_on_recovery INTEGER default 0, escalate_on_down INTEGER default 0, escalate_on_unreachable INTEGER default 0, CONSTRAINT PK_hostescalation_id PRIMARY KEY (hostescalation_id) , CONSTRAINT UQ_hostescalations UNIQUE (instance_id,config_type,host_object_id,timeperiod_object_id,first_notification,last_notification))
CREATE TABLE icinga_contactnotificationmethods ( contactnotificationmethod_id bigserial, instance_id bigint default 0, contactnotification_id bigint default 0, start_time timestamp, start_time_usec INTEGER default 0, end_time timestamp, end_time_usec INTEGER default 0, command_object_id bigint default 0, command_args TEXT default '', CONSTRAINT PK_contactnotificationmethod_id PRIMARY KEY (contactnotificationmethod_id) , CONSTRAINT UQ_contactnotificationmethods UNIQUE (instance_id,contactnotification_id,start_time,start_time_usec))
CREATE TABLE icinga_comments ( comment_id bigserial, instance_id bigint default 0, entry_time timestamp, entry_time_usec INTEGER default 0, comment_type INTEGER default 0, entry_type INTEGER default 0, object_id bigint default 0, comment_time timestamp, internal_comment_id bigint default 0, author_name TEXT default '', comment_data TEXT default '', is_persistent INTEGER default 0, comment_source INTEGER default 0, expires INTEGER default 0, expiration_time timestamp, name TEXT default NULL, session_token INTEGER default NULL, CONSTRAINT PK_comment_id PRIMARY KEY (comment_id))
CREATE INDEX contactgroup_members_i_id_idx on icinga_contactgroup_members(instance_id);
CREATE INDEX host_contacts_i_id_idx on icinga_host_contacts(instance_id);
CREATE INDEX idx_zonestatus_object_id on icinga_zonestatus(zone_object_id);
CREATE TABLE icinga_zones ( zone_id bigserial, instance_id bigint default 0, zone_object_id bigint default 0, parent_zone_object_id bigint default 0, config_type integer default 0, is_global integer default 0, CONSTRAINT PK_zone_id PRIMARY KEY (zone_id) , CONSTRAINT UQ_zones UNIQUE (instance_id,config_type,zone_object_id))
CREATE TABLE IF NOT EXISTS icinga_contactnotificationmethods ( contactnotificationmethod_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, contactnotification_id bigint unsigned default 0, start_time timestamp NULL, start_time_usec int default 0, end_time timestamp NULL, end_time_usec int default 0, command_object_id bigint unsigned default 0, command_args TEXT character set latin1, PRIMARY KEY (contactnotificationmethod_id), UNIQUE KEY instance_id (instance_id,contactnotification_id,start_time,start_time_usec))
CREATE TABLE icinga_hostgroup_members ( hostgroup_member_id bigserial, instance_id bigint default 0, hostgroup_id bigint default 0, host_object_id bigint default 0, session_token INTEGER default NULL, CONSTRAINT PK_hostgroup_member_id PRIMARY KEY (hostgroup_member_id))
CREATE TABLE IF NOT EXISTS icinga_eventhandlers ( eventhandler_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, eventhandler_type smallint default 0, object_id bigint unsigned default 0, state smallint default 0, state_type smallint default 0, start_time timestamp NULL, start_time_usec int default 0, end_time timestamp NULL, end_time_usec int default 0, command_object_id bigint unsigned default 0, command_args TEXT character set latin1, command_line TEXT character set latin1, timeout smallint default 0, early_timeout smallint default 0, execution_time double default '0', return_code smallint default 0, output TEXT character set latin1, long_output TEXT, PRIMARY KEY (eventhandler_id), UNIQUE KEY instance_id (instance_id,object_id,start_time,start_time_usec))
CREATE TABLE icinga_statehistory ( statehistory_id bigserial, instance_id bigint default 0, state_time timestamp, state_time_usec INTEGER default 0, object_id bigint default 0, state_change INTEGER default 0, state INTEGER default 0, state_type INTEGER default 0, current_check_attempt INTEGER default 0, max_check_attempts INTEGER default 0, last_state INTEGER default '-1', last_hard_state INTEGER default '-1', output TEXT default '', long_output TEXT default '', check_source varchar(255) default '', CONSTRAINT PK_statehistory_id PRIMARY KEY (statehistory_id))
CREATE INDEX customvariables_i_id_idx on icinga_customvariables(instance_id);
CREATE TABLE icinga_contact_notificationcommands ( contact_notificationcommand_id bigserial, instance_id bigint default 0, contact_id bigint default 0, notification_type INTEGER default 0, command_object_id bigint default 0, command_args TEXT default '', CONSTRAINT PK_contact_notificationcommand_id PRIMARY KEY (contact_notificationcommand_id) , CONSTRAINT UQ_contact_notificationcommands UNIQUE (contact_id,notification_type,command_object_id,command_args))
CREATE INDEX icinga_customvariables_i ON icinga_customvariables(varname);
CREATE INDEX d_t_hist_object_id_idx on icinga_downtimehistory(object_id);
CREATE TABLE icinga_commenthistory ( commenthistory_id bigserial, instance_id bigint default 0, entry_time timestamp, entry_time_usec INTEGER default 0, comment_type INTEGER default 0, entry_type INTEGER default 0, object_id bigint default 0, comment_time timestamp, internal_comment_id bigint default 0, author_name TEXT default '', comment_data TEXT default '', is_persistent INTEGER default 0, comment_source INTEGER default 0, expires INTEGER default 0, expiration_time timestamp, deletion_time timestamp, deletion_time_usec INTEGER default 0, name TEXT default NULL, CONSTRAINT PK_commenthistory_id PRIMARY KEY (commenthistory_id))
CREATE TABLE icinga_host_parenthosts ( host_parenthost_id bigserial, instance_id bigint default 0, host_id bigint default 0, parent_host_object_id bigint default 0, CONSTRAINT PK_host_parenthost_id PRIMARY KEY (host_parenthost_id))
CREATE TABLE IF NOT EXISTS icinga_zones ( zone_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, zone_object_id bigint(20) unsigned DEFAULT '0', config_type smallint(6) DEFAULT '0', parent_zone_object_id bigint(20) unsigned DEFAULT '0', is_global smallint(6), config_hash varchar(64) DEFAULT NULL, PRIMARY KEY (zone_id))
CREATE TABLE icinga_servicechecks ( servicecheck_id bigserial, instance_id bigint default 0, service_object_id bigint default 0, check_type INTEGER default 0, current_check_attempt INTEGER default 0, max_check_attempts INTEGER default 0, state INTEGER default 0, state_type INTEGER default 0, start_time timestamp, start_time_usec INTEGER default 0, end_time timestamp, end_time_usec INTEGER default 0, command_object_id bigint default 0, command_args TEXT default '', command_line TEXT default '', timeout INTEGER default 0, early_timeout INTEGER default 0, execution_time double precision default 0, latency double precision default 0, return_code INTEGER default 0, output TEXT default '', long_output TEXT default '', perfdata TEXT default '', CONSTRAINT PK_servicecheck_id PRIMARY KEY (servicecheck_id))
CREATE INDEX sched_d_t_start_time_idx on icinga_scheduleddowntime(scheduled_start_time);
CREATE INDEX contactgroups_i_id_idx on icinga_contactgroups(instance_id);
CREATE INDEX hoststatus_notif_enabled_idx on icinga_hoststatus(notifications_enabled);
CREATE INDEX idx_hostdependencies ON icinga_hostdependencies(instance_id,config_type,host_object_id,dependent_host_object_id,dependency_type,inherits_parent,fail_on_up,fail_on_down,fail_on_unreachable);
CREATE TABLE IF NOT EXISTS icinga_zonestatus ( zonestatus_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, zone_object_id bigint(20) unsigned DEFAULT '0', status_update_time timestamp NOT NULL, parent_zone_object_id bigint(20) unsigned DEFAULT '0', PRIMARY KEY (zonestatus_id))
CREATE INDEX scgrps_sid_cgoid ON icinga_service_contactgroups (service_id,contactgroup_object_id);
CREATE INDEX externalcommands_i_id_idx on icinga_externalcommands(instance_id);
CREATE INDEX hoststatus_ex_time_idx on icinga_hoststatus(execution_time);
CREATE INDEX c_hist_i_c_id_idx on icinga_logentries(internal_comment_id);
CREATE TABLE IF NOT EXISTS icinga_scheduleddowntime ( scheduleddowntime_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, downtime_type smallint default 0, object_id bigint unsigned default 0, entry_time timestamp NULL, author_name varchar(64) character set latin1 default '', comment_data TEXT character set latin1, internal_downtime_id bigint unsigned default 0, triggered_by_id bigint unsigned default 0, is_fixed smallint default 0, duration bigint(20) default 0, scheduled_start_time timestamp NULL, scheduled_end_time timestamp NULL, was_started smallint default 0, actual_start_time timestamp NULL, actual_start_time_usec int default 0, is_in_effect smallint default 0, trigger_time timestamp NULL, name TEXT character set latin1 default NULL, session_token int default NULL, PRIMARY KEY (scheduleddowntime_id))
CREATE INDEX idx_zonestatus_parent_object_id on icinga_zonestatus(parent_zone_object_id);
CREATE INDEX servicechecks_time_id_idx on icinga_servicechecks(start_time);
CREATE INDEX services_host_object_id_idx on icinga_services(host_object_id);
CREATE TABLE icinga_hostescalation_contactgroups ( hostescalation_contactgroup_id bigserial, instance_id bigint default 0, hostescalation_id bigint default 0, contactgroup_object_id bigint default 0, CONSTRAINT PK_hostescalation_contactgroup_id PRIMARY KEY (hostescalation_contactgroup_id) , CONSTRAINT UQ_hostescalation_contactgroups UNIQUE (hostescalation_id,contactgroup_object_id))
CREATE INDEX icinga_objects_i ON icinga_objects(objecttype_id,name1,name2);
CREATE INDEX serviceesc_cgroups_i_id_idx on icinga_serviceescalation_contactgroups(instance_id);
CREATE INDEX idx_comments_remove ON icinga_comments (object_id, entry_time);
CREATE INDEX idx_endpointstatus_object_id on icinga_endpointstatus(endpoint_object_id);
CREATE INDEX contacts_i_id_idx on icinga_contacts(instance_id);
CREATE INDEX service_contacts_i_id_idx on icinga_service_contacts(instance_id);
CREATE INDEX idx_servicegroup_members_object_id on icinga_servicegroup_members(service_object_id);
CREATE INDEX sla_idx_dohist ON icinga_downtimehistory (object_id, actual_start_time, actual_end_time);
CREATE INDEX srvcstatus_last_state_chg_idx on icinga_servicestatus(last_state_change);
CREATE INDEX loge_inst_id_time_idx on icinga_logentries (instance_id, logentry_time);
CREATE INDEX idx_servicedependencies_dependent_service_object_id on icinga_servicedependencies(dependent_service_object_id);
CREATE INDEX commenthistory_delete_idx ON icinga_commenthistory (instance_id, comment_time, internal_comment_id);
CREATE INDEX notification_object_id_idx ON icinga_notifications(object_id);
create index statehist_state_idx on icinga_statehistory(object_id,
SELECT instance_id FROM " + GetTablePrefix() + "instances WHERE instance_name = E'" + Escape(instanceName) + "'
CREATE TABLE icinga_hostchecks ( hostcheck_id bigserial, instance_id bigint default 0, host_object_id bigint default 0, check_type INTEGER default 0, is_raw_check INTEGER default 0, current_check_attempt INTEGER default 0, max_check_attempts INTEGER default 0, state INTEGER default 0, state_type INTEGER default 0, start_time timestamp, start_time_usec INTEGER default 0, end_time timestamp, end_time_usec INTEGER default 0, command_object_id bigint default 0, command_args TEXT default '', command_line TEXT default '', timeout INTEGER default 0, early_timeout INTEGER default 0, execution_time double precision default 0, latency double precision default 0, return_code INTEGER default 0, output TEXT default '', long_output TEXT default '', perfdata TEXT default '', CONSTRAINT PK_hostcheck_id PRIMARY KEY (hostcheck_id))
CREATE TABLE IF NOT EXISTS icinga_customvariables ( customvariable_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, object_id bigint unsigned default 0, config_type smallint default 0, has_been_modified smallint default 0, varname varchar(255) character set latin1 collate latin1_general_cs default NULL, varvalue TEXT character set latin1, is_json smallint default 0, PRIMARY KEY (customvariable_id), UNIQUE KEY object_id_2 (object_id,config_type,varname), KEY varname (varname))
CREATE INDEX service_contactgroups_i_id_idx on icinga_service_contactgroups(instance_id);
CREATE TABLE IF NOT EXISTS icinga_hostescalation_contactgroups ( hostescalation_contactgroup_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, hostescalation_id bigint unsigned default 0, contactgroup_object_id bigint unsigned default 0, PRIMARY KEY (hostescalation_contactgroup_id), UNIQUE KEY instance_id (hostescalation_id,contactgroup_object_id))
CREATE INDEX timeperiod_timeranges_i_id_idx on icinga_timeperiod_timeranges(instance_id);
CREATE INDEX idx_statehistory_cleanup on icinga_statehistory(instance_id, state_time);
CREATE TABLE icinga_dbversion ( dbversion_id bigserial, name TEXT default '', version TEXT default '', create_time timestamp, modify_time timestamp, CONSTRAINT PK_dbversion_id PRIMARY KEY (dbversion_id) , CONSTRAINT UQ_dbversion UNIQUE (name))
CREATE INDEX externalcommands_time_id_idx on icinga_externalcommands(entry_time);
CREATE TABLE IF NOT EXISTS icinga_hostchecks ( hostcheck_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, host_object_id bigint unsigned default 0, check_type smallint default 0, is_raw_check smallint default 0, current_check_attempt smallint default 0, max_check_attempts smallint default 0, state smallint default 0, state_type smallint default 0, start_time timestamp NULL, start_time_usec int default 0, end_time timestamp NULL, end_time_usec int default 0, command_object_id bigint unsigned default 0, command_args TEXT character set latin1, command_line TEXT character set latin1, timeout smallint default 0, early_timeout smallint default 0, execution_time double default '0', latency double default '0', return_code smallint default 0, output TEXT character set latin1, long_output TEXT, perfdata TEXT character set latin1, PRIMARY KEY (hostcheck_id))
CREATE TABLE icinga_zonestatus ( zonestatus_id bigserial, instance_id bigint default 0, zone_object_id bigint default 0, parent_zone_object_id bigint default 0, status_update_time timestamp with time zone default '1970-01-01 00:00:00+00', CONSTRAINT PK_zonestatus_id PRIMARY KEY (zonestatus_id) , CONSTRAINT UQ_zonestatus UNIQUE (zone_object_id))
CREATE INDEX sla_idx_sthist ON icinga_statehistory (object_id, state_time 
CREATE TABLE icinga_flappinghistory ( flappinghistory_id bigserial, instance_id bigint default 0, event_time timestamp, event_time_usec INTEGER default 0, event_type INTEGER default 0, reason_type INTEGER default 0, flapping_type INTEGER default 0, object_id bigint default 0, percent_state_change double precision default 0, low_threshold double precision default 0, high_threshold double precision default 0, comment_time timestamp, internal_comment_id bigint default 0, CONSTRAINT PK_flappinghistory_id PRIMARY KEY (flappinghistory_id))
CREATE INDEX hostchks_h_obj_id_idx on icinga_hostchecks(host_object_id);
CREATE INDEX d_t_hist_entry_time_idx on icinga_downtimehistory(entry_time);
CREATE TABLE icinga_configfilevariables ( configfilevariable_id bigserial, instance_id bigint default 0, configfile_id bigint default 0, varname TEXT default '', varvalue TEXT default '', CONSTRAINT PK_configfilevariable_id PRIMARY KEY (configfilevariable_id))
CREATE INDEX idx_contactgroup_members_object_id on icinga_contactgroup_members(contact_object_id);
CREATE INDEX idx_endpointstatus_zone_object_id on icinga_endpointstatus(zone_object_id);
CREATE TABLE icinga_servicegroups ( servicegroup_id bigserial, instance_id bigint default 0, config_type INTEGER default 0, servicegroup_object_id bigint default 0, alias TEXT default '', notes TEXT default NULL, notes_url TEXT default NULL, action_url TEXT default NULL, config_hash varchar(64) DEFAULT NULL, CONSTRAINT PK_servicegroup_id PRIMARY KEY (servicegroup_id) , CONSTRAINT UQ_servicegroups UNIQUE (instance_id,config_type,servicegroup_object_id))
CREATE INDEX servicegroup_members_i_id_idx on icinga_servicegroup_members(instance_id);
CREATE INDEX idx_comments_session_del ON icinga_comments (instance_id, session_token);
CREATE TABLE icinga_eventhandlers ( eventhandler_id bigserial, instance_id bigint default 0, eventhandler_type INTEGER default 0, object_id bigint default 0, state INTEGER default 0, state_type INTEGER default 0, start_time timestamp, start_time_usec INTEGER default 0, end_time timestamp, end_time_usec INTEGER default 0, command_object_id bigint default 0, command_args TEXT default '', command_line TEXT default '', timeout INTEGER default 0, early_timeout INTEGER default 0, execution_time double precision default 0, return_code INTEGER default 0, output TEXT default '', long_output TEXT default '', CONSTRAINT PK_eventhandler_id PRIMARY KEY (eventhandler_id) , CONSTRAINT UQ_eventhandlers UNIQUE (instance_id,object_id,start_time,start_time_usec))
SELECT object_id, objecttype_id, name1, name2, is_active FROM " + GetTablePrefix() + "objects WHERE instance_id = 
CREATE TABLE IF NOT EXISTS icinga_host_contacts ( host_contact_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, host_id bigint unsigned default 0, contact_object_id bigint unsigned default 0, PRIMARY KEY (host_contact_id))
CREATE TABLE icinga_contactstatus ( contactstatus_id bigserial, instance_id bigint default 0, contact_object_id bigint default 0, status_update_time timestamp, host_notifications_enabled INTEGER default 0, service_notifications_enabled INTEGER default 0, last_host_notification timestamp, last_service_notification timestamp, modified_attributes INTEGER default 0, modified_host_attributes INTEGER default 0, modified_service_attributes INTEGER default 0, CONSTRAINT PK_contactstatus_id PRIMARY KEY (contactstatus_id) , CONSTRAINT UQ_contactstatus UNIQUE (contact_object_id))
CREATE TABLE icinga_timeperiods ( timeperiod_id bigserial, instance_id bigint default 0, config_type INTEGER default 0, timeperiod_object_id bigint default 0, alias TEXT default '', config_hash varchar(64) DEFAULT NULL, CONSTRAINT PK_timeperiod_id PRIMARY KEY (timeperiod_id) , CONSTRAINT UQ_timeperiods UNIQUE (instance_id,config_type,timeperiod_object_id))
CREATE INDEX sched_d_t_object_id_idx on icinga_scheduleddowntime(object_id);
CREATE INDEX idx_commenthistory_remove ON icinga_commenthistory (object_id, entry_time);
CREATE TABLE IF NOT EXISTS icinga_service_contactgroups ( service_contactgroup_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, service_id bigint unsigned default 0, contactgroup_object_id bigint unsigned default 0, PRIMARY KEY (service_contactgroup_id))
CREATE INDEX hostgroup_members_i_id_idx on icinga_hostgroup_members(instance_id);
CREATE TABLE icinga_downtimehistory ( downtimehistory_id bigserial, instance_id bigint default 0, downtime_type INTEGER default 0, object_id bigint default 0, entry_time timestamp, author_name TEXT default '', comment_data TEXT default '', internal_downtime_id bigint default 0, triggered_by_id bigint default 0, is_fixed INTEGER default 0, duration BIGINT default 0, scheduled_start_time timestamp, scheduled_end_time timestamp, was_started INTEGER default 0, actual_start_time timestamp, actual_start_time_usec INTEGER default 0, actual_end_time timestamp, actual_end_time_usec INTEGER default 0, was_cancelled INTEGER default 0, is_in_effect INTEGER default 0, trigger_time timestamp, name TEXT default NULL, CONSTRAINT PK_downtimehistory_id PRIMARY KEY (downtimehistory_id))
CREATE INDEX loge_time_idx on icinga_logentries(logentry_time);
CREATE INDEX hoststatus_p_state_chg_idx on icinga_hoststatus(percent_state_change);
CREATE INDEX systemcommands_time_id_idx on icinga_systemcommands(start_time);
CREATE TABLE icinga_contactgroup_members ( contactgroup_member_id bigserial, instance_id bigint default 0, contactgroup_id bigint default 0, contact_object_id bigint default 0, session_token INTEGER default NULL, CONSTRAINT PK_contactgroup_member_id PRIMARY KEY (contactgroup_member_id))
CREATE INDEX configfilevariables_i_id_idx on icinga_configfilevariables(instance_id);
CREATE INDEX hoststatus_pas_chks_en_idx on icinga_hoststatus(passive_checks_enabled);
CREATE TABLE IF NOT EXISTS icinga_host_contactgroups ( host_contactgroup_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, host_id bigint unsigned default 0, contactgroup_object_id bigint unsigned default 0, PRIMARY KEY (host_contactgroup_id))
CREATE INDEX timeperiods_i_id_idx on icinga_timeperiods(instance_id);
CREATE INDEX runtimevariables_i_id_idx on icinga_runtimevariables(instance_id);
CREATE TABLE icinga_notifications ( notification_id bigserial, instance_id bigint default 0, notification_type INTEGER default 0, notification_reason INTEGER default 0, object_id bigint default 0, start_time timestamp, start_time_usec INTEGER default 0, end_time timestamp, end_time_usec INTEGER default 0, state INTEGER default 0, output TEXT default '', long_output TEXT default '', escalated INTEGER default 0, contacts_notified INTEGER default 0, CONSTRAINT PK_notification_id PRIMARY KEY (notification_id) , CONSTRAINT UQ_notifications UNIQUE (instance_id,object_id,start_time,start_time_usec))
CREATE INDEX hoststatus_act_chks_en_idx on icinga_hoststatus(active_checks_enabled);
CREATE INDEX srvcstatus_stat_upd_time_idx on icinga_servicestatus(status_update_time);
CREATE INDEX hoststatus_latency_idx on icinga_hoststatus(latency);
CREATE TABLE IF NOT EXISTS icinga_processevents ( processevent_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, event_type smallint default 0, event_time timestamp NULL, event_time_usec int default 0, process_id bigint unsigned default 0, program_name varchar(16) character set latin1 default '', program_version varchar(20) character set latin1 default '', program_date varchar(10) character set latin1 default '', PRIMARY KEY (processevent_id))
CREATE INDEX c_hist_instance_id_idx on icinga_logentries(instance_id);
CREATE TABLE icinga_logentries ( logentry_id bigserial, instance_id bigint default 0, logentry_time timestamp, entry_time timestamp, entry_time_usec INTEGER default 0, logentry_type INTEGER default 0, logentry_data TEXT default '', realtime_data INTEGER default 0, inferred_data_extracted INTEGER default 0, object_id bigint default NULL, CONSTRAINT PK_logentry_id PRIMARY KEY (logentry_id))
CREATE INDEX hoststatus_stat_upd_time_idx on icinga_hoststatus(status_update_time);
CREATE INDEX srvcstatus_flap_det_en_idx on icinga_servicestatus(flap_detection_enabled);
CREATE INDEX customvariablestatus_i_id_idx on icinga_customvariablestatus(instance_id);
CREATE INDEX sla_idx_obj ON icinga_objects (objecttype_id, is_active, name1);
CREATE TABLE IF NOT EXISTS icinga_servicechecks ( servicecheck_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, service_object_id bigint unsigned default 0, check_type smallint default 0, current_check_attempt smallint default 0, max_check_attempts smallint default 0, state smallint default 0, state_type smallint default 0, start_time timestamp NULL, start_time_usec int default 0, end_time timestamp NULL, end_time_usec int default 0, command_object_id bigint unsigned default 0, command_args TEXT character set latin1, command_line TEXT character set latin1, timeout smallint default 0, early_timeout smallint default 0, execution_time double default '0', latency double default '0', return_code smallint default 0, output TEXT character set latin1, long_output TEXT, perfdata TEXT character set latin1, PRIMARY KEY (servicecheck_id))
CREATE INDEX hoststatus_i_id_idx on icinga_hoststatus(instance_id);
CREATE TABLE icinga_contactgroups ( contactgroup_id bigserial, instance_id bigint default 0, config_type INTEGER default 0, contactgroup_object_id bigint default 0, alias TEXT default '', config_hash varchar(64) DEFAULT NULL, CONSTRAINT PK_contactgroup_id PRIMARY KEY (contactgroup_id) , CONSTRAINT UQ_contactgroups UNIQUE (instance_id,config_type,contactgroup_object_id))
CREATE INDEX servicestatus_i_id_idx on icinga_servicestatus(instance_id);
SELECT version FROM " + GetTablePrefix() + "dbversion WHERE name=E'" + Escape(dbVersionName) + "'
CREATE INDEX hoststatus_last_state_chg_idx on icinga_hoststatus(last_state_change);
CREATE INDEX contacts_object_id_idx ON icinga_contacts(contact_object_id);
CREATE INDEX idx_zones_parent_object_id on icinga_zones(parent_zone_object_id);
CREATE TABLE IF NOT EXISTS icinga_downtimehistory ( downtimehistory_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, downtime_type smallint default 0, object_id bigint unsigned default 0, entry_time timestamp NULL, author_name varchar(64) character set latin1 default '', comment_data TEXT character set latin1, internal_downtime_id bigint unsigned default 0, triggered_by_id bigint unsigned default 0, is_fixed smallint default 0, duration bigint(20) default 0, scheduled_start_time timestamp NULL, scheduled_end_time timestamp NULL, was_started smallint default 0, actual_start_time timestamp NULL, actual_start_time_usec int default 0, actual_end_time timestamp NULL, actual_end_time_usec int default 0, was_cancelled smallint default 0, is_in_effect smallint default 0, trigger_time timestamp NULL, name TEXT character set latin1 default NULL, PRIMARY KEY (downtimehistory_id))
CREATE INDEX host_parenthosts_i_id_idx on icinga_host_parenthosts(instance_id);
CREATE INDEX instances_name_idx on icinga_instances(instance_name);
CREATE TABLE IF NOT EXISTS icinga_contactnotifications ( contactnotification_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, notification_id bigint unsigned default 0, contact_object_id bigint unsigned default 0, start_time timestamp NULL, start_time_usec int default 0, end_time timestamp NULL, end_time_usec int default 0, PRIMARY KEY (contactnotification_id), UNIQUE KEY instance_id (instance_id,contact_object_id,start_time,start_time_usec))
CREATE INDEX sched_d_t_downtime_type_idx on icinga_scheduleddowntime(downtime_type);
CREATE TABLE IF NOT EXISTS icinga_objects ( object_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, objecttype_id bigint unsigned default 0, name1 varchar(128) character set latin1 collate latin1_general_cs default '', name2 varchar(128) character set latin1 collate latin1_general_cs default NULL, is_active smallint default 0, PRIMARY KEY (object_id), KEY objecttype_id (objecttype_id,name1,name2))
CREATE TABLE IF NOT EXISTS icinga_serviceescalation_contacts ( serviceescalation_contact_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, serviceescalation_id bigint unsigned default 0, contact_object_id bigint unsigned default 0, PRIMARY KEY (serviceescalation_contact_id), UNIQUE KEY instance_id (instance_id,serviceescalation_id,contact_object_id))
SELECT status_update_time, endpoint_name FROM icinga_programstatus;
CREATE TABLE IF NOT EXISTS icinga_runtimevariables ( runtimevariable_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, varname varchar(64) character set latin1 default '', varvalue TEXT character set latin1, PRIMARY KEY (runtimevariable_id))
CREATE INDEX icinga_customvariablestatus_i ON icinga_customvariablestatus(varname);
CREATE INDEX commands_i_id_idx on icinga_commands(instance_id);
CREATE TABLE IF NOT EXISTS icinga_servicegroup_members ( servicegroup_member_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, servicegroup_id bigint unsigned default 0, service_object_id bigint unsigned default 0, PRIMARY KEY (servicegroup_member_id))
CREATE TABLE IF NOT EXISTS icinga_instances ( instance_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_name varchar(64) character set latin1 default '', instance_description varchar(128) character set latin1 default '', PRIMARY KEY (instance_id))
CREATE TABLE icinga_hostescalation_contacts ( hostescalation_contact_id bigserial, instance_id bigint default 0, hostescalation_id bigint default 0, contact_object_id bigint default 0, CONSTRAINT PK_hostescalation_contact_id PRIMARY KEY (hostescalation_contact_id) , CONSTRAINT UQ_hostescalation_contacts UNIQUE (instance_id,hostescalation_id,contact_object_id))
CREATE INDEX idx_endpoints_zone_object_id on icinga_endpoints(zone_object_id);
CREATE TABLE icinga_customvariablestatus ( customvariablestatus_id bigserial, instance_id bigint default 0, object_id bigint default 0, status_update_time timestamp, has_been_modified INTEGER default 0, varname TEXT default '', varvalue TEXT default '', is_json INTEGER default 0, session_token INTEGER default NULL, CONSTRAINT PK_customvariablestatus_id PRIMARY KEY (customvariablestatus_id) , CONSTRAINT UQ_customvariablestatus UNIQUE (object_id,varname))
CREATE TABLE icinga_contact_addresses ( contact_address_id bigserial, instance_id bigint default 0, contact_id bigint default 0, address_number INTEGER default 0, address TEXT default '', CONSTRAINT PK_contact_address_id PRIMARY KEY (contact_address_id) , CONSTRAINT UQ_contact_addresses UNIQUE (contact_id,address_number))
CREATE INDEX hostchecks_time_id_idx on icinga_hostchecks(start_time);
CREATE TABLE IF NOT EXISTS icinga_configfilevariables ( configfilevariable_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, configfile_id bigint unsigned default 0, varname varchar(64) character set latin1 default '', varvalue TEXT character set latin1, PRIMARY KEY (configfilevariable_id))
CREATE INDEX srvcstatus_latency_idx on icinga_servicestatus(latency);
CREATE INDEX hoststatus_flap_det_en_idx on icinga_hoststatus(flap_detection_enabled);
CREATE INDEX cntgrpmbrs_cgid_coid ON icinga_contactgroup_members (contactgroup_id,contact_object_id);
CREATE INDEX hoststatus_problem_ack_idx on icinga_hoststatus(problem_has_been_acknowledged);
CREATE INDEX hoststatus_is_flapping_idx on icinga_hoststatus(is_flapping);
CREATE TABLE IF NOT EXISTS icinga_endpointstatus ( endpointstatus_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, endpoint_object_id bigint(20) unsigned DEFAULT '0', zone_object_id bigint(20) unsigned DEFAULT '0', status_update_time timestamp NULL, identity varchar(255) DEFAULT NULL, node varchar(255) DEFAULT NULL, is_connected smallint(6), PRIMARY KEY (endpointstatus_id))
CREATE INDEX hstgrpmbrs_hgid_hoid ON icinga_hostgroup_members (hostgroup_id,host_object_id);
CREATE TABLE icinga_serviceescalation_contactgroups ( serviceescalation_contactgroup_id bigserial, instance_id bigint default 0, serviceescalation_id bigint default 0, contactgroup_object_id bigint default 0, CONSTRAINT PK_serviceescalation_contactgroup_id PRIMARY KEY (serviceescalation_contactgroup_id) , CONSTRAINT UQ_serviceescalation_contactgro UNIQUE (serviceescalation_id,contactgroup_object_id))
CREATE INDEX idx_downtimehistory_remove ON icinga_downtimehistory (object_id, entry_time, scheduled_start_time, scheduled_end_time);
CREATE TABLE IF NOT EXISTS icinga_timeperiods ( timeperiod_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, config_type smallint default 0, timeperiod_object_id bigint unsigned default 0, alias varchar(255) character set latin1 default '', config_hash varchar(64) DEFAULT NULL, PRIMARY KEY (timeperiod_id), UNIQUE KEY instance_id (instance_id,config_type,timeperiod_object_id))
CREATE INDEX hosts_host_object_id_idx on icinga_hosts(host_object_id);
CREATE INDEX idx_endpoints_object_id on icinga_endpoints(endpoint_object_id);
CREATE INDEX idx_servicedependencies ON icinga_servicedependencies(instance_id,config_type,service_object_id,dependent_service_object_id,dependency_type,inherits_parent,fail_on_ok,fail_on_warning,fail_on_unknown,fail_on_critical);
CREATE INDEX idx_customvariables_object_id on icinga_customvariables(object_id);
CREATE TABLE IF NOT EXISTS icinga_configfiles ( configfile_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, configfile_type smallint default 0, configfile_path varchar(255) character set latin1 default '', PRIMARY KEY (configfile_id), UNIQUE KEY instance_id (instance_id,configfile_type,configfile_path))
CREATE TABLE IF NOT EXISTS icinga_hostescalations ( hostescalation_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, config_type smallint default 0, host_object_id bigint unsigned default 0, timeperiod_object_id bigint unsigned default 0, first_notification smallint default 0, last_notification smallint default 0, notification_interval double default '0', escalate_on_recovery smallint default 0, escalate_on_down smallint default 0, escalate_on_unreachable smallint default 0, PRIMARY KEY (hostescalation_id), UNIQUE KEY instance_id (instance_id,config_type,host_object_id,timeperiod_object_id,first_notification,last_notification))
CREATE INDEX hostesc_contacts_i_id_idx on icinga_hostescalation_contacts(instance_id);
create index idx_downtimehistory_remove on icinga_downtimehistory (object_id, entry_time, scheduled_start_time, scheduled_end_time);
CREATE TABLE icinga_runtimevariables ( runtimevariable_id bigserial, instance_id bigint default 0, varname TEXT default '', varvalue TEXT default '', CONSTRAINT PK_runtimevariable_id PRIMARY KEY (runtimevariable_id))
CREATE INDEX idx_hostgroup_members_object_id on icinga_hostgroup_members(host_object_id);
CREATE INDEX idx_scheduleddowntime_remove ON icinga_scheduleddowntime (object_id, entry_time, scheduled_start_time, scheduled_end_time);
CREATE TABLE icinga_instances ( instance_id bigserial, instance_name TEXT default '', instance_description TEXT default '', CONSTRAINT PK_instance_id PRIMARY KEY (instance_id))
CREATE INDEX idx_hostdependencies_dependent_host_object_id on icinga_hostdependencies(dependent_host_object_id);
CREATE TABLE IF NOT EXISTS icinga_externalcommands ( externalcommand_id bigint(20) unsigned NOT NULL AUTO_INCREMENT, instance_id bigint unsigned default 0, entry_time timestamp NULL, command_type smallint default 0, command_name varchar(128) character set latin1 default '', command_args TEXT character set latin1, PRIMARY KEY (externalcommand_id))
SELECT version FROM " + GetTablePrefix() + "dbversion WHERE name='" + Escape(dbVersionName) + "'
CREATE TABLE icinga_hostdependencies ( hostdependency_id bigserial, instance_id bigint default 0, config_type INTEGER default 0, host_object_id bigint default 0, dependent_host_object_id bigint default 0, dependency_type INTEGER default 0, inherits_parent INTEGER default 0, timeperiod_object_id bigint default 0, fail_on_up INTEGER default 0, fail_on_down INTEGER default 0, fail_on_unreachable INTEGER default 0, CONSTRAINT PK_hostdependency_id PRIMARY KEY (hostdependency_id))
CREATE INDEX srvcstatus_state_type_idx on icinga_servicestatus(state_type);
CREATE INDEX hostchecks_i_id_idx on icinga_hostchecks(instance_id);
CREATE TABLE icinga_commands ( command_id bigserial, instance_id bigint default 0, config_type INTEGER default 0, object_id bigint default 0, command_line TEXT default '', config_hash varchar(64) DEFAULT NULL, CONSTRAINT PK_command_id PRIMARY KEY (command_id) , CONSTRAINT UQ_commands UNIQUE (instance_id,object_id,config_type))
CREATE TABLE icinga_externalcommands ( externalcommand_id bigserial, instance_id bigint default 0, entry_time timestamp, command_type INTEGER default 0, command_name TEXT default '', command_args TEXT default '', CONSTRAINT PK_externalcommand_id PRIMARY KEY (externalcommand_id))
CREATE TABLE icinga_host_contactgroups ( host_contactgroup_id bigserial, instance_id bigint default 0, host_id bigint default 0, contactgroup_object_id bigint default 0, CONSTRAINT PK_host_contactgroup_id PRIMARY KEY (host_contactgroup_id))
CREATE INDEX serviceesc_i_id_idx on icinga_serviceescalations(instance_id);
