CREATE TABLE `row_version`(	`key` VARCHAR(100) NOT NULL PRIMARY KEY,	`value` VARCHAR(100) NOT NULL)
SELECT 1 FROM `version`
CREATE TABLE `subscribed`(	`id_forum` INT NOT NULL COMMENT 'id форума',	`is_first` TINYINT(1) NOT NULL COMMENT 'была ли раньше подписка на форум true - нет, false - да',	PRIMARY KEY (`id_forum`))
CREATE TABLE `message`(	`id` INTEGER NOT NULL PRIMARY KEY,	`id_topic` INTEGER NOT NULL,	`id_parent` INTEGER NOT NULL,	`id_user` INTEGER NOT NULL,	`id_forum` INTEGER NOT NULL,	`subject` VARCHAR(128) NOT NULL,	`message_name` VARCHAR(160) NOT NULL,	`user_nick` VARCHAR(100) NOT NULL,	`message` BLOB NOT NULL,	`id_article` INTEGER NOT NULL,	`message_date` INTEGER NOT NULL,	`update_date` INTEGER NOT NULL,	`user_role` VARCHAR(50) NOT NULL,	`user_title` VARCHAR(100) NOT NULL,	`user_title_color` INTEGER NOT NULL,	`last_moderated` INTEGER NOT NULL,	`closed` INTEGER NOT NULL,	`has_child` INTEGER NOT NULL,	`compressed` INTEGER NOT NULL)
CREATE TABLE `group`(	`id` INTEGER NOT NULL PRIMARY KEY,	`name` VARCHAR(100) NOT NULL,	`sort_order` INTEGER NOT NULL)
CREATE TABLE `forum`(	`id` INTEGER NOT NULL PRIMARY KEY,	`id_group` INTEGER NOT NULL,	`short_name` VARCHAR(64) NOT NULL,	`name` VARCHAR(128) NOT NULL,	`rated` INTEGER NOT NULL,	`in_top` INTEGER NOT NULL,	`rate_limit` INTEGER NOT NULL)
CREATE TABLE `message_topic`(	`id_message` INTEGER NOT NULL PRIMARY KEY,	`id_forum` INTEGER NOT NULL,	`message_date` INTEGER NOT NULL,	FOREIGN KEY (`id_message`) REFERENCES `message` (`id`) ON DELETE CASCADE ON UPDATE CASCADE)
CREATE TABLE `moderate2send`(	`id` INTEGER NOT NULL PRIMARY KEY,	`id_message` INTEGER NOT NULL,	`action` VARCHAR(32) NOT NULL,	`id_forum` INTEGER NOT NULL,	`description` TEXT NOT NULL,	`as_moderator` INTEGER NOT NULL,	`date` INTEGER NOT NULL)
CREATE TABLE `user`(	`id` INTEGER NOT NULL PRIMARY KEY,	`name` VARCHAR(60) NOT NULL,	`nick` VARCHAR(100) NOT NULL,	`real_name` VARCHAR(80) NOT NULL,	`email` VARCHAR(60) NOT NULL,	`homepage` VARCHAR(120) NOT NULL,	`specialization` VARCHAR(100) NOT NULL,	`where_from` VARCHAR(100) NOT NULL,	`origin` VARCHAR(258) NOT NULL)
CREATE TABLE `rating`(	`id_message` INTEGER NOT NULL,	`id_topic` INTEGER NOT NULL,	`id_user` INTEGER NOT NULL,	`user_rating` INTEGER NOT NULL,	`rate` INTEGER NOT NULL,	`rate_date` INTEGER NOT NULL,	`rate_type` INTEGER NOT NULL,	PRIMARY KEY (`id_message`, `id_user`, `rate_type`))
CREATE TABLE `forum`(	`id` INT NOT NULL COMMENT 'id',	`id_group` INT NOT NULL COMMENT 'id группы форумов',	`short_name` VARCHAR(64) NOT NULL COMMENT 'короткое имя форума',	`name` VARCHAR(128) NOT NULL COMMENT 'полное имя форума',	`rated` INT NOT NULL COMMENT 'оценивается ли форум',	`in_top` INT NOT NULL COMMENT 'участвует ли оценки этого форума в топе',	`rate_limit` INT NOT NULL COMMENT 'лимит оценки в форуме',	PRIMARY KEY (`id`))
CREATE TABLE `moderate`(	`id_message` INTEGER NOT NULL,	`id_topic` INTEGER NOT NULL,	`id_user` INTEGER NOT NULL,	`id_forum` INTEGER NOT NULL,	`created` INTEGER NOT NULL,	PRIMARY KEY (`id_message`, `id_user`))
CREATE TABLE `subscribed`(	`id_forum` INTEGER NOT NULL PRIMARY KEY,	`is_first` INTEGER NOT NULL)
CREATE TABLE `row_version`(	`key` VARCHAR(100) NOT NULL COMMENT 'ключ версии',	`value` VARCHAR(100) NOT NULL COMMENT 'значение версии',	PRIMARY KEY (`key`))
CREATE TABLE `broken`(	`id_message` INTEGER NOT NULL PRIMARY KEY,	`is_topic` INTEGER NOT NULL)
CREATE TABLE `version`(	`key` VARCHAR(100) NOT NULL PRIMARY KEY,	`value` VARCHAR(100) NOT NULL)
CREATE TABLE `message_topic`(	`id_message` INT NOT NULL COMMENT 'id сообщения',	`id_forum` INT NOT NULL COMMENT 'id форума',	`message_date` DATETIME NOT NULL COMMENT 'дата создания сообщения',	PRIMARY KEY (`id_message`),	KEY `ix_id_forum` (`id_forum`),	CONSTRAINT `fk_message_topic_message` FOREIGN KEY (`id_message`) REFERENCES `message` (`id`) ON DELETE CASCADE ON UPDATE CASCADE)
CREATE TABLE `message2send`(	`id` INT NOT NULL COMMENT 'id сообщения (локальный)',	`id_parent` INT NOT NULL COMMENT 'id родителя',	`id_forum` INT NOT NULL COMMENT 'id форума',	`subject` VARCHAR(128) NOT NULL COMMENT 'тема',	`message` LONGTEXT NOT NULL COMMENT 'текст сообщения',	`date` DATETIME NOT NULL COMMENT 'дата и время занесения',	`draft` TINYINT(1) NOT NULL COMMENT 'флаг черновика',	PRIMARY KEY (`id`))
CREATE TABLE `rating2send`(	`id` INTEGER NOT NULL PRIMARY KEY,	`id_message` INTEGER NOT NULL,	`rate` INTEGER NOT NULL,	`date` INTEGER NOT NULL)
CREATE TABLE `message2send`(	`id` INTEGER NOT NULL PRIMARY KEY,	`id_parent` INTEGER NOT NULL,	`id_forum` INTEGER NOT NULL,	`subject` VARCHAR(128) NOT NULL,	`message` TEXT NOT NULL,	`date` INTEGER NOT NULL,	`draft` INTEGER NOT NULL)
CREATE TABLE `unread`(	`id_message` INTEGER NOT NULL PRIMARY KEY,	`id_parent` INTEGER NOT NULL,	`id_forum` INTEGER NOT NULL,	`id_topic` INTEGER NOT NULL,	`id_parent_user` INTEGER NOT NULL,	`message_date` INTEGER NOT NULL)
CREATE TABLE `version`(	`key` VARCHAR(100) NOT NULL COMMENT 'ключ версии',	`value` VARCHAR(100) NOT NULL COMMENT 'значение версии',	PRIMARY KEY (`key`))
CREATE TABLE `user`(	`id` INT NOT NULL COMMENT 'id пользователя',	`name` VARCHAR(60) NOT NULL COMMENT 'логин пользователя',	`nick` VARCHAR(100) NOT NULL COMMENT 'псевдоним пользователя',	`real_name` VARCHAR(80) NOT NULL COMMENT 'реальное имя пользователя',	`email` VARCHAR(60) NOT NULL COMMENT 'публичный email пользователя',	`homepage` VARCHAR(120) NOT NULL COMMENT 'домашняя страница',	`specialization` VARCHAR(100) NOT NULL COMMENT 'специализация',	`where_from` VARCHAR(100) NOT NULL COMMENT 'откуда',	`origin` VARCHAR(258) NOT NULL COMMENT 'подпись',	PRIMARY KEY (`id`),	KEY `ix_name` (`name`))
CREATE TABLE `group`(	`id` INT NOT NULL COMMENT 'id',	`name` VARCHAR(100) NOT NULL COMMENT 'наименование группы',	`sort_order` INT NOT NULL COMMENT 'порядок сортировки',	PRIMARY KEY (`id`))
CREATE TABLE `broken`(	`id_message` INT NOT NULL COMMENT 'id топика/сообщения',	`is_topic` TINYINT(1) NOT NULL COMMENT 'флаг того, что это топик, а не сообщение',	PRIMARY KEY (`id_message`))
CREATE TABLE `rating`(	`id_message` INT NOT NULL COMMENT 'id сообщения',	`id_topic` INT NOT NULL COMMENT 'id топика',	`id_user` INT NOT NULL COMMENT 'id пользователя',	`user_rating` INT NOT NULL COMMENT 'рейтинг пользователя',	`rate` INT NOT NULL COMMENT 'оценка',	`rate_date` DATETIME NOT NULL COMMENT 'дата',	`rate_type` TINYINT(1) NOT NULL COMMENT 'тип оценки (0 - смайл, 1 - +/-, 2 - балл)',	PRIMARY KEY (`id_message`, `id_user`, `rate_type`))
CREATE TABLE `unread`(	`id_message` INT NOT NULL COMMENT 'id непрочитанного сообщения',	`id_parent` INT NOT NULL COMMENT 'id родительского сообщения',	`id_forum` INT NOT NULL COMMENT 'id форума',	`id_topic` INT NOT NULL COMMENT 'id топика',	`id_parent_user` INT NOT NULL COMMENT 'id пользователя, которому идет ответ',	`message_date` DATETIME NOT NULL COMMENT 'дата отправки сообщения',	PRIMARY KEY (`id_message`))
CREATE TABLE `moderate`(	`id_message` INT NOT NULL COMMENT 'id сообщения',	`id_topic` INT NOT NULL COMMENT 'id топика',	`id_user` INT NOT NULL COMMENT 'id пользователя',	`id_forum` INT NOT NULL COMMENT 'id форума',	`created` DATETIME NOT NULL COMMENT 'дата',	PRIMARY KEY (`id_message`, `id_user`))
CREATE TABLE `rating2send`(	`id` INT NOT NULL COMMENT 'id (локальный)',	`id_message` INT NOT NULL COMMENT 'id сообщения',	`rate` INT NOT NULL COMMENT 'рейтинг',	`date` DATETIME NOT NULL COMMENT 'дата добавления',	PRIMARY KEY (`id`))
